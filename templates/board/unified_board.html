{% extends "base.html" %}
{% load static %}
{% load humanize %}
{% load profile_tags %}
{% load time_filters %}
`
{% block body_class %}platform-page board-page{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'glocalization_app/css/02-platform-layout.css' %}">
<link rel="stylesheet" href="{% static 'glocalization_app/css/post-detail/post-detail.css' %}">
<link rel="stylesheet" href="{% static 'glocalization_app/css/board/board.css' %}">
{% endblock %}

{% block site-header-content %}
<div class="feed-nav header">
    <span class="feed-nav-icon-container">
        <a href="javascript:history.back()" class="nav-link js-back-link">
            <span class="nav-link__icon">
                {% include 'icons/detail-page/back-botton.html' %}
            </span>
            <span class="nav-link__label">Back</span>
        </a>
    </span>
</div>
{% endblock %}

{% block content %}
<main class="platform-feed">
    <div class="feed-content container-fluid" id="postContainer">
        <!-- Board Items — FULL CARD STYLE -->
        <article class="feed-card feed-card--detail">
            {% for item in items %}
                {% with obj=item.obj type=item.type %}
                {% if obj %}
                    <div class="listings feed-card" onclick="window.location=`{% if type == 'post' %}{% url 'post_detail' obj.id %}{% else %}{% url 'seekers:seeker_detail' obj.id %}{% endif %}`">
                        <a href="{% if type == 'post' %}{% url 'post_detail' obj.id %}{% else %}{% url 'seekers:seeker_detail' obj.id %}{% endif %}"
                        class="text-decoration-none text-dark">

                            <!-- <div class="feed-card-header">
                                {% profile_picture obj.author size=48 css_class="feed-card-avatar" %}
                                <div class="feed-card-meta">
                                    <div class="feed-card-author">
                                        <span class="feed-card-name">
                                            {{ obj.author.profile.business_name }}
                                        </span>
                                        <span class="feed-card-time">• {{ obj.created_at|short_time }}</span>
                                    </div>
                                </div>
                            </div> -->
                            <!-- {% if obj.author_phone_number %}
                            <span class="">
                                <a href="tel:{{ obj.author_phone_number }}" class="">
                                    <i class="fa-solid fa-phone"></i>
                                </a>
                            </span>
                            {% endif %}
                            <div class="feed-card-body">  -->

                                <!-- Title -->
                                <!-- <h3 class="feed-card-title fs-5 mb-2">
                                    {% if type == "post" %}
                                        {{ obj.product_name }}
                                    {% else %}
                                        {{ obj.title|default:"Looking for..." }}
                                    {% endif %}
                                </h3> -->

                                <!-- Description -->
                                <span>
                                    <strong>
                                    <center>
                                        {{ obj.author.profile.business_name }} <span class="">• {{ obj.created_at|short_time }}</span>
                                    </center>
                                    </strong>
                                </span>

                                <div class="feed-card-text feed-card-text--detail mb-3">
                                    {{ obj.description|urlize|truncatewords:15 }}
                                </div>

                                <!-- Meta Info -->
                                <!-- <div class="d-flex flex-wrap gap-3 text-muted small">
                                    <span><i class="fas fa-globe me-1"></i>{{ obj.availability_scope }}</span>
                                    <span><i class="fas fa-tag me-1"></i>{{ obj.category.name }}</span>
                                    {% if obj.price %}
                                        <span class="text-success fw-bold"><i class="fas fa-dollar-sign me-1"></i>{{ obj.price|intcomma }}</span>
                                    {% endif %}
                                </div> -->

                                <!-- Location -->
                                <div class="text-muted small">
                                    <i class="fas fa-map-marker-alt"></i>
                                    {% if obj.post_town %}{{ obj.post_town.name }}{% elif obj.post_town_input %}{{ obj.post_town_input }}{% endif %}
                                    {% if obj.post_state %}, {{ obj.post_state.name }}{% endif %}
                                    {% if obj.post_country %}, {{ obj.post_country.name }}{% endif %}
                                </div>

                                <!-- Media Preview -->
                                <!-- {% if obj.media_files.first %}
                                <div class="mt-3">
                                    <img src="{{ obj.media_files.first.file.url }}" 
                                        alt="Preview" 
                                        class="rounded w-100" 
                                        style="max-height:300px; object-fit:cover;">
                                </div>
                                {% endif %} -->
                            <!-- Phone CTA if available -->
                            <!-- </div> -->
                        </a>
                    </div>
                {% else %}
                    <!-- Orphaned board entry -->
                    <div class="feed-card text-muted text-center">
                        <i class="fas fa-trash-alt fa-2x mb-3"></i>
                        <p>This item was removed or is no longer available.</p>
                    </div>
                {% endif %}
                {% endwith %}
            {% empty %}
                <div class="text-center py-5 mx-3">
                    <i class="fas fa-bullhorn fa-4x text-muted mb-4"></i>
                    <h3 class="text-muted">Quiet on the board</h3>
                    <p class="text-muted">No public notices right now. Check back soon!</p>
                </div>
            {% endfor %}
        </article>
    </div>
</main>
{% endblock %}
