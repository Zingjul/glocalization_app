{% extends "staff/base.html" %}
{% block content %}
<h2 class="section-title">üìç Pending Location Requests</h2>

{% if post_requests or seeker_requests or person_requests %}
<table class="moderation-table">
  <thead>
    <tr>
      <th>Town Name</th>
      <th>Parent State</th>
      <th>Type</th>
      <th>Linked Item</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for req in post_requests %}
    <tr>
      <td>{{ req.typed_town }}</td>
      <td>{{ req.parent_state.name }}</td>
      <td><span class="badge bg-primary">Product Post</span></td>
      <td><a href="{{ req.post.get_absolute_url }}" target="_blank">Post #{{ req.post.id }}</a></td>
      <td>
        <form action="{% url 'staff:approve_location' req.pk %}" method="post" style="display:inline;">
          {% csrf_token %}
          <button class="approve-btn">Approve</button>
        </form>
        <form action="{% url 'staff:reject_location' req.pk %}" method="post" style="display:inline;">
          {% csrf_token %}
          <button class="reject-btn">Reject</button>
        </form>
      </td>
    </tr>
    {% endfor %}

    {% for req in seeker_requests %}
    <tr>
      <td>{{ req.typed_town }}</td>
      <td>{{ req.parent_state.name }}</td>
      <td><span class="badge bg-warning text-dark">Seeker Post</span></td>
      <td><a href="{{ req.post.get_absolute_url }}" target="_blank">Seeker #{{ req.post.id }}</a></td>
      <td>
        <form action="{% url 'staff:approve_location' req.pk %}" method="post" style="display:inline;">
          {% csrf_token %}
          <button class="approve-btn">Approve</button>
        </form>
        <form action="{% url 'staff:reject_location' req.pk %}" method="post" style="display:inline;">
          {% csrf_token %}
          <button class="reject-btn">Reject</button>
        </form>
      </td>
    </tr>
    {% endfor %}

    {% for req in person_requests %}
    <tr>
      <td>{{ req.typed_town }}</td>
      <td>{{ req.parent_state.name }}</td>
      <td><span class="badge bg-success">Person</span></td>
      <td>{{ req.person.full_name }}</td>
      <td>
        <form action="{% url 'staff:approve_location' req.pk %}" method="post" style="display:inline;">
          {% csrf_token %}
          <button class="approve-btn">Approve</button>
        </form>
        <form action="{% url 'staff:reject_location' req.pk %}" method="post" style="display:inline;">
          {% csrf_token %}
          <button class="reject-btn">Reject</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p>No pending location requests üéâ</p>
{% endif %}
{% endblock %}
