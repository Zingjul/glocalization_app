{% extends "base.html" %}
{% block content %}
  <h1>Search Posts</h1>

  <form method="get" action="">
    <!-- 🔍 Free-text search -->
    <input type="text" name="q" placeholder="Search posts..." value="{{ request.GET.q }}">

    <!-- 🔽 Scope dropdown -->
    <label for="availability_scope">Scope:</label>
    <select name="availability_scope" id="availability_scope">
      <option value="">-- Select --</option>
      <option value="continent" {% if request.GET.availability_scope == "continent" %}selected{% endif %}>Continent</option>
      <option value="country" {% if request.GET.availability_scope == "country" %}selected{% endif %}>Country</option>
      <option value="state" {% if request.GET.availability_scope == "state" %}selected{% endif %}>State</option>
      <option value="town" {% if request.GET.availability_scope == "town" %}selected{% endif %}>Town</option>
    </select>

    <!-- 🌍 Import reusable location fields -->
    {% include "posts/includes/location_fields.html" %}

    <button type="submit">Search & Filter</button>
  </form>

  <hr>

  {% if posts %}
    <ul>
      {% for post in posts %}
        <li>
          <a href="{% url 'post_detail' post.pk %}">{{ post.title }}</a>
          – {{ post.business_name }} ({{ post.created_at|date:"SHORT_DATE_FORMAT" }})
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No posts matched your search/filter.</p>
  {% endif %}
{% endblock %}
